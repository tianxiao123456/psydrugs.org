---
layout: page
title: å¤„æ–¹ç”Ÿæˆå™¨
description: åŒ»é™¢å¤„æ–¹å•ç”Ÿæˆå·¥å…·
date: 2025-12-22
updated: 2025-12-22
comments: false
---

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
  .prescription-form {
    max-width: 900px;
    margin: 2rem auto;
    padding: 2rem;
    background: var(--card);
    border-radius: 16px;
  }

  .form-section {
    margin-bottom: 2rem;
    padding-bottom: 2rem;
    border-bottom: 2px dashed var(--block-border);
  }

  .form-section:last-child {
    border-bottom: none;
  }

  .form-section h3 {
    margin-bottom: 1rem;
    color: var(--text-p0);
    font-size: 1.2rem;
  }

  .form-group {
    margin-bottom: 1rem;
  }

  .form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: var(--text-p0);
    font-size: 0.95rem;
  }

  .form-group input,
  .form-group select,
  .form-group textarea {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid var(--block-border);
    border-radius: 8px;
    background: var(--block);
    color: var(--text-p0);
    font-size: 1rem;
  }

  .form-group textarea {
    min-height: 120px;
    resize: vertical;
    font-family: inherit;
  }

  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
  }

  .form-row-3 {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 1.5rem;
  }

  .btn-generate {
    width: 100%;
    padding: 1rem;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s;
  }

  .btn-generate:hover {
    transform: translateY(-2px);
  }

  .btn-generate:active {
    transform: translateY(0);
  }

  .result-container {
    margin-top: 2rem;
    padding: 2rem;
    background: var(--block);
    border-radius: 12px;
    display: none;
  }

  .result-container.show {
    display: block;
  }

  .warning-box {
    padding: 1rem;
    margin-bottom: 2rem;
    background: rgba(255, 152, 0, 0.1);
    border-left: 4px solid #ff9800;
    border-radius: 4px;
  }

  .prescription-preview {
    background: white;
    color: black;
    padding: 1.5rem;
    border: 2px solid #333;
    border-radius: 4px;
    font-family: 'SimSun', 'Microsoft YaHei', serif;
    font-size: 12px;
    line-height: 1.6;
    /* A5 å°ºå¯¸æ¯”ä¾‹: 148mm x 210mm */
    width: 100%;
    max-width: 592px;
    min-height: 840px;
    margin: 0 auto;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  @media print {
    @page {
      size: A5 portrait;
      margin: 10mm;
    }

    .prescription-preview {
      width: 148mm;
      height: 210mm;
      border: none;
      box-shadow: none;
      page-break-after: always;
    }

    .warning-box,
    .prescription-form,
    .btn-generate {
      display: none;
    }
  }

  .prescription-header {
    display: grid;
    grid-template-columns: 1fr 2fr;
    border: 2px solid #333;
    margin-bottom: 1rem;
  }

  .prescription-header>div {
    padding: 0.5rem;
    border-right: 2px solid #333;
  }

  .prescription-header>div:last-child {
    border-right: none;
  }

  .header-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    padding: 0.5rem;
  }

  .prescription-content {
    line-height: 2;
    margin-bottom: 2rem;
  }

  .prescription-footer {
    text-align: right;
    margin-top: 3rem;
    padding-top: 1rem;
    border-top: 1px solid #ccc;
  }
</style>

<div class="warning-box">
  âš ï¸ <strong>é‡è¦æç¤ºï¼š</strong>æœ¬å·¥å…·ä»…ä¾›å­¦ä¹ å‚è€ƒä½¿ç”¨ï¼Œç”Ÿæˆçš„å¤„æ–¹å•ä¸å…·æœ‰æ³•å¾‹æ•ˆåŠ›ï¼Œä¸å¯ç”¨äºå®é™…å°±åŒ»ã€‚
</div>

<div class="prescription-form">
  <div class="form-section">
    <h3>ğŸ“‹ åŸºæœ¬ä¿¡æ¯</h3>

    <div class="form-group">
      <label for="hospital-name">åŒ»é™¢åç§°</label>
      <input type="text" id="hospital-name" placeholder="ä¾‹å¦‚ï¼šÃ—Ã—å¸‚äººæ°‘åŒ»é™¢">
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="clinic-number">é—¨è¯Šå·</label>
        <input type="text" id="clinic-number" placeholder="ä¾‹å¦‚ï¼š2025122200001">
      </div>

      <div class="form-group">
        <label for="visit-time">å°±è¯Šæ—¶é—´</label>
        <input type="datetime-local" id="visit-time">
      </div>
    </div>

    <div class="form-row-3">
      <div class="form-group">
        <label for="patient-name">å§“å</label>
        <input type="text" id="patient-name" placeholder="æ‚£è€…å§“å">
      </div>

      <div class="form-group">
        <label for="gender">æ€§åˆ«</label>
        <select id="gender">
          <option value="">è¯·é€‰æ‹©</option>
          <option value="ç”·">ç”·</option>
          <option value="å¥³">å¥³</option>
        </select>
      </div>

      <div class="form-group">
        <label for="age">å¹´é¾„</label>
        <input type="number" id="age" placeholder="å¹´é¾„" min="0" max="150">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="contact">è”ç³»æ–¹å¼</label>
        <input type="text" id="contact" placeholder="æ‰‹æœºå·ç ">
      </div>

      <div class="form-group">
        <label for="department">ç§‘å®¤</label>
        <input type="text" id="department" placeholder="ä¾‹å¦‚ï¼šç²¾ç¥ç§‘">
      </div>
    </div>
  </div>

  <div class="form-section">
    <h3>ğŸ“ è¯Šç–—ä¿¡æ¯</h3>

    <div class="form-group">
      <label for="condition">ç—…æƒ…æ¼”å˜</label>
      <textarea id="condition" placeholder="æè¿°æ‚£è€…ç—…æƒ…çš„å‘å±•è¿‡ç¨‹ã€ä¸»è¦ç—‡çŠ¶ã€æŒç»­æ—¶é—´ç­‰..."></textarea>
    </div>

    <div class="form-group">
      <label for="examination">è¾…åŠ©æ£€æŸ¥</label>
      <textarea id="examination" placeholder="å·²å®Œæˆçš„æ£€æŸ¥é¡¹ç›®åŠç»“æœï¼Œå¦‚è¡€å¸¸è§„ã€å½±åƒå­¦æ£€æŸ¥ç­‰..."></textarea>
    </div>

    <div class="form-group">
      <label for="diagnosis">ä¸»è¦è¯Šæ–­</label>
      <textarea id="diagnosis" placeholder="æ ¹æ®ç—‡çŠ¶å’Œæ£€æŸ¥ç»“æœç»™å‡ºçš„è¯Šæ–­..."></textarea>
    </div>

    <div class="form-group">
      <label for="treatment">è¯Šç–—æ„è§</label>
      <textarea id="treatment" placeholder="æ²»ç–—æ–¹æ¡ˆã€ç”¨è¯å»ºè®®ã€æ³¨æ„äº‹é¡¹ã€å¤è¯Šæ—¶é—´ç­‰..."></textarea>
    </div>
  </div>

  <div class="form-section">
    <h3>ğŸ‘¨â€âš•ï¸ åŒ»å¸ˆä¿¡æ¯</h3>

    <div class="form-group">
      <label for="doctor-name">åŒ»å¸ˆç­¾å</label>
      <input type="text" id="doctor-name" placeholder="åŒ»å¸ˆå§“å">
    </div>
  </div>

  <button class="btn-generate" onclick="generatePrescription()">
    ğŸ“„ ç”Ÿæˆå¤„æ–¹é¢„è§ˆ
  </button>
</div>

<div class="result-container" id="result">
  <h2>ğŸ“ å¤„æ–¹é¢„è§ˆ</h2>
  <div class="prescription-preview" id="preview"></div>
  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1.5rem;">
    <button class="btn-generate" onclick="downloadPDF()">
      ğŸ“„ ä¸‹è½½PDFå¤„æ–¹
    </button>
    <button class="btn-generate" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);"
      onclick="window.print()">
      ğŸ–¨ï¸ æ‰“å°å¤„æ–¹
    </button>
  </div>
</div>

<script>
  // è®¾ç½®é»˜è®¤å°±è¯Šæ—¶é—´ä¸ºå½“å‰æ—¶é—´
  document.addEventListener('DOMContentLoaded', function () {
    const now = new Date();
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const day = String(now.getDate()).padStart(2, '0');
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    document.getElementById('visit-time').value = `${year}-${month}-${day}T${hours}:${minutes}`;
  });

  function generatePrescription() {
    const hospitalName = document.getElementById('hospital-name').value;
    const clinicNumber = document.getElementById('clinic-number').value;
    const visitTime = document.getElementById('visit-time').value;
    const patientName = document.getElementById('patient-name').value;
    const gender = document.getElementById('gender').value;
    const age = document.getElementById('age').value;
    const contact = document.getElementById('contact').value;
    const department = document.getElementById('department').value;
    const condition = document.getElementById('condition').value;
    const examination = document.getElementById('examination').value;
    const diagnosis = document.getElementById('diagnosis').value;
    const treatment = document.getElementById('treatment').value;
    const doctorName = document.getElementById('doctor-name').value;

    // åŸºç¡€éªŒè¯
    if (!hospitalName || !patientName || !gender || !doctorName) {
      alert('è¯·å¡«å†™å¿…å¡«ä¿¡æ¯ï¼ˆåŒ»é™¢åç§°ã€å§“åã€æ€§åˆ«ã€åŒ»å¸ˆç­¾åï¼‰');
      return;
    }

    // æ ¼å¼åŒ–æ—¶é—´
    const formattedTime = visitTime ? new Date(visitTime).toLocaleString('zh-CN', {
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit'
    }) : '';

    // ç”Ÿæˆå¤„æ–¹HTML
    let html = `
    <table style="width: 100%; border-collapse: collapse; border: 2px solid #000; margin-bottom: 1.5rem;">
      <tr>
        <td style="border: 1px solid #000; padding: 8px; font-weight: bold; text-align: center;" colspan="3"><strong>åŒ»é™¢åç§°ï¼š</strong>${hospitalName || '___________'}</td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 8px; width: 33.3%;"><strong>é—¨è¯Šå·ï¼š</strong>${clinicNumber || '___________'}</td>
        <td style="border: 1px solid #000; padding: 8px; width: 33.3%;"><strong>æ€§åˆ«ï¼š</strong>${gender || '___'}</td>
        <td style="border: 1px solid #000; padding: 8px; width: 33.3%;"><strong>å¹´é¾„ï¼š</strong>${age || '___'}å²</td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 8px;"><strong>å§“åï¼š</strong>${patientName || '___________'}</td>
        <td style="border: 1px solid #000; padding: 8px;"><strong>è”ç³»æ–¹å¼ï¼š</strong>${contact || '___________'}</td>
        <td style="border: 1px solid #000; padding: 8px;"><strong>ç§‘å®¤ï¼š</strong>${department || '___________'}</td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 8px; font-weight: bold; text-align: center;" colspan="3"><strong>å°±è¯Šæ—¶é—´ï¼š</strong>${formattedTime || '___________'}</td>
      </tr>
    </table>
    
    <div style="border-bottom: 2px solid #333; margin: 1rem 0;"></div>
    
    <div style="margin-bottom: 1rem;">
      <div style="font-weight: bold; margin-bottom: 0.3rem; font-size: 0.95rem;">ç—…æƒ…æ¼”å˜ï¼š</div>
      <div style="line-height: 1.5; text-indent: 2em; min-height: 40px; white-space: pre-wrap; font-size: 0.9rem;">${condition || 'ï¼ˆæœªå¡«å†™ï¼‰'}</div>
    </div>
    
    <div style="margin-bottom: 1rem;">
      <div style="font-weight: bold; margin-bottom: 0.3rem; font-size: 0.95rem;">è¾…åŠ©æ£€æŸ¥ï¼š</div>
      <div style="line-height: 1.5; text-indent: 2em; min-height: 40px; white-space: pre-wrap; font-size: 0.9rem;">${examination || 'ï¼ˆæœªå¡«å†™ï¼‰'}</div>
    </div>
    
    <div style="margin-bottom: 1rem;">
      <div style="font-weight: bold; margin-bottom: 0.3rem; font-size: 0.95rem;">ä¸»è¦è¯Šæ–­ï¼š</div>
      <div style="line-height: 1.5; text-indent: 2em; min-height: 30px; white-space: pre-wrap; font-size: 0.9rem;">${diagnosis || 'ï¼ˆæœªå¡«å†™ï¼‰'}</div>
    </div>
    
    <div style="margin-bottom: 1.5rem;">
      <div style="font-weight: bold; margin-bottom: 0.3rem; font-size: 0.95rem;">è¯Šç–—æ„è§ï¼š</div>
      <div style="line-height: 1.5; text-indent: 2em; min-height: 50px; white-space: pre-wrap; font-size: 0.9rem;">${treatment || 'ï¼ˆæœªå¡«å†™ï¼‰'}</div>
    </div>
    
    <div style="margin-bottom: 1.5rem;">
      <div style="font-weight: bold; margin-bottom: 0.5rem; font-size: 0.95rem;">æ³¨æ„äº‹é¡¹ï¼š</div>
      <div style="line-height: 1.8; font-size: 0.85rem; text-indent: 2em;">
        å»ºè®®å®šæœŸå¤è¯Šï¼Œå¦¥å–„ä¿ç®¡è¯å“ï¼ŒæŒ‰åŒ»å˜±æœè¯ï¼Œå·²å‘ŠçŸ¥å¸¸è§è¯ç‰©ä¸è‰¯ååº”è¯¦è§è¯´æ˜ä¹¦ï¼Œæœè¯åé¿å…é¥®é…’ã€é©¾é©¶ã€é«˜ç©ºä½œä¸šæˆ–æ“ä½œå±é™©æœºæ¢°ã€‚è‹¥ç—…æƒ…åŠ é‡æˆ–å‡ºç°æ˜æ˜¾ä¸è‰¯ååº”ï¼Œéšæ—¶å°±è¯Šæˆ‘é™¢ï¼›è‹¥åŒæ—¶æ‚£æœ‰èº¯ä½“ç–¾ç—…ï¼Œå»ºè®®åˆ°ç»¼åˆåŒ»é™¢å°±è¯Šã€‚
      </div>
    </div>
    
    <div style="text-align: right; margin-top: 2rem; padding-top: 0.8rem; border-top: 1px solid #999;">
      <div style="margin-bottom: 0.3rem; font-size: 0.9rem;">åŒ»å¸ˆç­¾åï¼š<span style="font-size: 1.1rem; font-weight: bold; margin-left: 0.5rem;">${doctorName}</span></div>
      <div style="color: #666; font-size: 0.85rem;">å¤„æ–¹æ—¥æœŸï¼š${new Date().toLocaleDateString('zh-CN')}</div>
    </div>
  `;

    document.getElementById('preview').innerHTML = html;
    document.getElementById('result').classList.add('show');

    // æ»šåŠ¨åˆ°ç»“æœ
    document.getElementById('result').scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  function downloadPDF() {
    const { jsPDF } = window.jspdf;
    const preview = document.getElementById('preview');

    if (!preview || !preview.innerHTML) {
      alert('è¯·å…ˆç”Ÿæˆå¤„æ–¹é¢„è§ˆ');
      return;
    }

    // ä½¿ç”¨html2canvaså°†HTMLè½¬æ¢ä¸ºcanvas
    html2canvas(preview, {
      scale: 2, // æé«˜æ¸…æ™°åº¦
      useCORS: true,
      logging: false,
      backgroundColor: '#ffffff'
    }).then(canvas => {
      const imgData = canvas.toDataURL('image/png');

      // åˆ›å»ºPDF
      const doc = new jsPDF({
        orientation: 'portrait',
        unit: 'mm',
        format: [148, 210] // A5 å°ºå¯¸
      });

      const imgWidth = 148;
      const imgHeight = (canvas.height * imgWidth) / canvas.width;

      doc.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);

      // è·å–æ‚£è€…å§“åç”¨äºæ–‡ä»¶å
      const patientName = document.getElementById('patient-name').value || 'æ‚£è€…';
      const fileName = `å¤„æ–¹å•_${patientName.replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g, '_')}_${new Date().getTime()}.pdf`;

      doc.save(fileName);
      alert('âœ… PDFå·²ç”Ÿæˆå¹¶å¼€å§‹ä¸‹è½½');
    }).catch(error => {
      console.error('ç”ŸæˆPDFå¤±è´¥:', error);
      alert('âŒ PDFç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•');
    });
  }

</script>